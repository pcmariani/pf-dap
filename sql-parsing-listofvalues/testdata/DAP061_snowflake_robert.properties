
# --- DPPs -------------------------------------------------------



# --- ddps -------------------------------------------------------
document.dynamic.userdefined.ddp_SourceSqlQueryId=25

document.dynamic.userdefined.ddp_sqlStatement=@file('DAP061_snowflake_robert.sql')
# document.dynamic.userdefined.ddp_sqlStatement=USE ROLE BTXPS_DOMAIN_ADMIN;\\n  \\n USE WAREHOUSE PFE_COMMON_WH_XS_01;\\n  \\n USE DATABASE BTXPS_NONGXP_SRC_SBX_DB;\\n  \\n USE SCHEMA PS_LABWARE_RAW;\\n  \\n SELECT DISTINCT\\n        S.LOGIN_BY\\n            S_LOGIN_BY,\\n        S.RECEIVED_BY\\n            S_RECEIVED_BY,\\n        S.REVIEWER\\n            S_REVIEWER,\\n        S.SAMPLE_NUMBER\\n            S_SAMPLE_NUMBER,\\n        S.PRODUCT\\n            S_PRODUCT,\\n        S.PRODUCT_VERSION\\n            S_PRODUCT_VERSION,\\n        S.PRODUCT_GRADE\\n            S_PRODUCT_GRADE,\\n        S.SPEC_TYPE\\n            S_SPEC_TYPE,\\n        S.STAGE\\n            S_STAGE,\\n        X_STAGE.DESCRIPTION\\n            S_X_STAGE_DESCRIPTION,\\n        S.SAMPLING_POINT\\n            S_SAMPLING_POINT,\\n        S.TEXT_ID\\n            S_TEXT_ID,\\n        S.RE_SAMPLE\\n            S_RE_SAMPLE,\\n        S.ORIGINAL_SAMPLE\\n            S_ORIGINAL_SAMPLE,\\n        S.ALIQUOT\\n            S_ALIQUOT,\\n        S.PARENT_ALIQUOT\\n            S_PARENT_ALIQUOT,\\n        S.DATE_REVIEWED\\n            S_DATE_REVIEWED,\\n        S.REVIEW_NOTE\\n            S_REVIEW_NOTE,\\n        S.SAMPLE_TYPE\\n            S_SAMPLE_TYPE,\\n        CASE\\n            WHEN S.DESCRIPTION IS NULL OR TRIM (S.DESCRIPTION) = '' THEN 'N/A'\\n            ELSE S.DESCRIPTION\\n        END\\n            S_DESCRIPTION,\\n        S.LOT\\n            S_LOT,\\n        S.LOT_NAME\\n            S_LOT_NAME,\\n        S.SAMPLE_NAME\\n            S_NAME,\\n        CASE\\n            WHEN X_COMPOUNDS.NAME IS NULL OR TRIM (X_COMPOUNDS.NAME) = ''\\n            THEN\\n                'N/A'\\n            ELSE\\n                X_COMPOUNDS.NAME\\n        END\\n            S_COMPOUND,\\n        S.TEMPLATE,\\n        --S.STATUS\\n        CASE\\n            WHEN S.STATUS = 'U' THEN 'Unreceived'\\n            WHEN S.STATUS = 'I' THEN 'Incomplete'\\n            WHEN S.STATUS = 'P' THEN 'In-Progress'\\n            WHEN S.STATUS = 'C' THEN 'Complete'\\n            WHEN S.STATUS = 'A' THEN 'Authorized'\\n            WHEN S.STATUS = 'R' THEN 'Rejected'\\n            WHEN S.STATUS = 'X' THEN 'Cancelled'\\n            WHEN TRIM (S.STATUS) = '' THEN 'N/A'\\n            ELSE S.STATUS\\n        END\\n            S_STATUS,\\n        S.EXT_LINK\\n            S_EXT_LINK,\\n        S.PROJECT\\n            S_PROJECT,\\n        S.LOCATION\\n            S_LOCATION,\\n        S.TIMEPOINT\\n            S_TIMEPOINT,\\n        S.CONDITION\\n            S_CONDITION,\\n        S.FORMULATION\\n            S_FORMULATION,\\n        S.PROTOCOL\\n            S_PROTOCOL,\\n        S.PROTOCOL_LEVEL\\n            S_PROTOCOL_LEVEL,\\n        S.X_NUM_CONTAINERS\\n            S_X_NUM_CONTAINERS,\\n        S.LOGIN_DATE\\n            S_LOGIN_DATE,\\n        S.RECD_DATE\\n            S_RECD_DATE,\\n        S.BASE_DATE\\n            S_BASE_DATE,\\n        S.AVAILABLE_DATE\\n            S_AVAILABLE_DATE,\\n        S.REQUIRED_DATE\\n            S_REQUIRED_DATE,\\n        S.TARGET_DATE\\n            S_TARGET_DATE,\\n        S.DATE_COMPLETED\\n            S_DATE_COMPLETED,\\n        --S.IN_SPEC                              S_IN_SPEC,\\n  \\n  \\n        CASE\\n            WHEN S.PRODUCT IS NULL\\n            THEN\\n                'N/A'\\n            WHEN TEST.X_TEST_TYPE IS NULL OR TEST.X_TEST_TYPE = 'ADDITIONAL'\\n            THEN\\n                'N/A'\\n            WHEN S.IN_SPEC = 'T'\\n            THEN\\n                'True'\\n            WHEN S.IN_SPEC = 'F'\\n            THEN\\n                'False'\\n            ELSE\\n                'N\\A'\\n        END\\n            S_IN_SPEC,\\n        CASE\\n            WHEN S.PRODUCT IS NULL THEN 'N/A'\\n            WHEN TEST.X_TEST_TYPE IS NULL OR S.IN_CONTROL = 'T' THEN 'N/A'\\n            WHEN S.IN_CONTROL = 'T' THEN 'True'\\n            WHEN S.IN_CONTROL = 'F' THEN 'False'\\n            ELSE 'N\\A'\\n        END\\n            S_IN_CONTROL,\\n        S.STAB_PULL_DATE\\n            S_STAB_PULL_DATE,\\n        S.STAB_PULL_BY\\n            S_STAB_PULL_BY,\\n        S.PARENT_SAMPLE\\n            S_PARENT_SAMPLE,\\n        S.X_HOLD_COND\\n            S_X_HOLD_COND,\\n        CASE\\n            WHEN S.TEMPLATE <> 'MAT_API_GENERIC' THEN 'N/A'\\n            WHEN (S.SAMPLE_VOLUME = 0 OR S.SAMPLE_VOLUME IS NULL) THEN 'N/A'\\n            ELSE S.SAMPLE_VOLUME || ' ' || 'Container'\\n        END\\n            S_VOLUME,\\n        S.SAMPLE_UNITS\\n            S_UNIT,\\n        TEST.DESCRIPTION\\n            T_DESCRIPTION,\\n        TEST.TEST_NUMBER\\n            T_TEST_NUMBER,\\n        TEST.STATUS\\n            T_STATUS,\\n        TEST.ANALYSIS\\n            T_ANALYSIS,\\n        TEST.TEST_COMMENT\\n            T_TEST_COMMENT,\\n        TEST.X_TEST_TYPE\\n            T_TEST_TYPE,\\n        TEST.IN_SPEC\\n            T_IN_SPEC,\\n        TEST.IN_CONTROL\\n            T_IN_CONTROL,\\n        TEST.ORDER_NUMBER\\n            T_ORDER_NUMBER,\\n        (SELECT LISTAGG (F.FOOT_NOTE, '; ')\\n                    WITHIN GROUP (ORDER BY F.FOOTNOTE_ID)\\n           FROM X_FOOTNOTES F\\n          WHERE     F.FOOTNOTE_KEYID = TEST.X_FOOTNOTE_KEYID\\n                AND F.REMOVED = 'F'\\n                AND F.FOOT_NOTE IS NOT NULL)\\n            T_FOOTNOTES,\\n        RESULT.RESULT_NUMBER\\n            R_RESULT_NUMBER,\\n        RESULT.NAME\\n            R_NAME,\\n        RESULT.ORDER_NUMBER\\n            R_ORDER_NUMBER,\\n        RESULT.STATUS\\n            R_STATUS,\\n        RESULT.REPLICATE_COUNT\\n            R_REPLICATE_COUNT,\\n        RESULT.UNITS\\n            R_UNITS,\\n        RESULT.FORMATTED_ENTRY\\n            R_FORMATTED_ENTRY,\\n        RESULT.ENTRY\\n            R_ENTRY,\\n        RESULT.REPORTABLE\\n            R_REPORTABLE,\\n        RESULT.REPORTED_NAME\\n            R_REPORTED_NAME,\\n        RESULT.DATE_ENTRY\\n            R_DATE_ENTRY,\\n        RESULT.RESULT_TYPE\\n            R_TYPE,\\n        HAZARD.LABEL_TEXT,\\n        CASE\\n            WHEN (   HAZARD.LABEL_TEXT IS NOT NULL\\n                  OR TRIM (HAZARD.LABEL_TEXT) <> '')\\n            THEN\\n                HAZARD.LABEL_TEXT\\n            WHEN (HAZARD.NAME IS NOT NULL OR TRIM (HAZARD.NAME) <> '')\\n            THEN\\n                HAZARD.NAME\\n            ELSE\\n                'N/A'\\n        END\\n            HAZARD_NAME,\\n        LIMS_USERS.FULL_NAME,\\n        CASE\\n            WHEN LOT.SUPPLIER IS NULL OR TRIM (LOT.SUPPLIER) = '' THEN 'N/A'\\n            ELSE LOT.SUPPLIER\\n        END\\n            SUPPLIER,\\n        ANALYSIS.ANALYSIS_TYPE,\\n        ANALYSIS.NAME,\\n        UNITS.DISPLAY_STRING\\n   FROM "BTXPS_NONGXP_SRC_SBX_DB"."PS_LABWARE_RAW"."SAMPLE" S,\\n                            TEST,\\n                            RESULT,\\n                            HAZARD,\\n                            LIMS_USERS,\\n                            ANALYSIS,\\n                            UNITS,\\n                            LOT,\\n                            X_COMPOUNDS,\\n                            X_STAGE\\n                      WHERE     S.SAMPLE_NUMBER = TEST.SAMPLE_NUMBER(+)\\n                            AND TEST.TEST_NUMBER = RESULT.TEST_NUMBER(+)\\n                            AND S.LOT = LOT.LOT_NUMBER(+)\\n                            AND S.SAMPLE_NUMBER = '120906'\\n                            AND (S.HAZARD = HAZARD.NAME(+))\\n                            AND (S.LOGIN_BY = LIMS_USERS.USER_NAME(+))\\n                            AND (S.RECEIVED_BY = LIMS_USERS.USER_NAME(+))\\n                            AND (S.REVIEWER = LIMS_USERS.USER_NAME(+))\\n                            AND (S.STAB_PULL_BY = LIMS_USERS.USER_NAME(+))\\n                            AND S.X_COMPOUND_ID = X_COMPOUNDS.COMPOUND_ID(+)\\n                            AND TEST.ANALYSIS = ANALYSIS.NAME(+)\\n                            AND (RESULT.UNITS = UNITS.UNIT_CODE(+))\\n                            AND (   ANALYSIS.ANALYSIS_TYPE IS NULL\\n                                 OR ANALYSIS.ANALYSIS_TYPE <> 'LIMS_SPECIFIC')\\n                            AND (S.STATUS IS NULL OR S.STATUS <> 'X')\\n                            AND (TEST.STATUS IS NULL OR TEST.STATUS <> 'X')\\n                            AND (RESULT.STATUS IS NULL OR RESULT.STATUS <> 'X')\\n                            AND S.STAGE = X_STAGE.NAME(+)\\n                   ORDER BY S_SAMPLE_NUMBER, T_TEST_NUMBER, R_RESULT_NUMBER;

document.dynamic.userdefined.ddp_TableDefinitionId=42
